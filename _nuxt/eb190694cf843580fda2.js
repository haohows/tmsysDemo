(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{238:function(t,e,n){var content=n(290);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(37).default)("6bbb6601",content,!0,{sourceMap:!1})},289:function(t,e,n){"use strict";var o=n(238);n.n(o).a},290:function(t,e,n){(e=n(36)(!1)).push([t.i,'.wrap[data-v-58d785ec]{width:calc(100vw - 400px);padding:15px;height:calc(100vh - 120px);overflow:auto}.wrap[data-v-58d785ec]::-webkit-scrollbar{display:none}h3[data-v-58d785ec]{border-bottom:2px solid rgba(230,226,226,.24706);padding-bottom:10px;margin-bottom:20px}.custom-file-label[data-v-58d785ec]:after{content:"上傳檔案"}.previewUI[data-v-58d785ec]{width:50px}.uiStyle[data-v-58d785ec]{padding:3px;text-align:center;font-size:16px;cursor:pointer;color:#beb9b9}.uiStyle.ui-active[data-v-58d785ec]{color:#2c3136}.preImgView[data-v-58d785ec]{background-position:50%;background-size:contain;background-repeat:no-repeat}.preEmptyView[data-v-58d785ec],.preImgView[data-v-58d785ec]{width:100%;min-height:263px;margin-top:10px;margin-bottom:10px}.preEmptyView[data-v-58d785ec]{background-color:#ece4e4;text-align:center;padding-top:90px;color:#bebebe;border-radius:3px}.preEmptyView span[data-v-58d785ec]{display:block}.propsEmptyView[data-v-58d785ec]{width:100%;min-height:176px;background-color:#ece4e4;text-align:center;padding-top:50px;color:#bebebe;margin-top:10px;margin-bottom:10px;border-radius:3px}.propsEmptyView span[data-v-58d785ec]{display:block}.gpsCheckbox[data-v-58d785ec]{border-left:none;padding-left:0}.remindBorder[data-v-58d785ec]{border:2px solid red;border-radius:5px;margin-bottom:0!important}.remindText[data-v-58d785ec]{color:red;margin-bottom:16px!important}.remindBorderBannerImg[data-v-58d785ec],.remindBorderPID[data-v-58d785ec]{border:2px solid red;border-radius:5px;margin-bottom:0!important}',""]),t.exports=e},309:function(t,e,n){"use strict";n.r(e);n(17),n(15),n(38),n(218);var o={layout:"layoutAdmin",data:function(){return{disabledCreateBtn:!1,propsEffect:"notHave",activePreview:"clue",createEventConfig:{clueImg:"",clueImgName:"尚未選擇檔案",theClueFileIsTooBig:!1,propsImg:"",propsImgName:"尚未選擇檔案",thePropsImgFileIsTooBig:!1,propsIcon:"",propsIconName:"尚未選擇檔案",thePropsIconFileIsTooBig:!1},eventContent:{name:"",answer:"",pass:!1,showGameImg:!1,showPropsImg:!1,score:""},remind:{name:"close",score:"close",answer:"close",clueImg:"close",propsImg:"close",propsIcon:"close"},taskMissionIntroduction:{},tasksystemSetting:{}}},watch:{propsEffect:function(t){"notHave"==t&&(this.activePreview="clue",this.remind.propsImg="close",this.remind.propsIcon="close")}},methods:{fileSelectImg:function(t){if(0!=t.target.files.length)if(this.validateFileSize(t),this.createEventConfig.theClueFileIsTooBig)this.createEventConfig.theClueFileIsTooBig=!1;else if(this.createEventConfig.thePropsImgFileIsTooBig)this.createEventConfig.thePropsImgFileIsTooBig=!1;else if(this.createEventConfig.thePropsIconFileIsTooBig)this.createEventConfig.thePropsIconFileIsTooBig=!1;else{var e=t.target.files.item(0);if("clue"==t.target.dataset.imgtype){this.createEventConfig.clueImgName=e.name;var n=new FileReader;n.addEventListener("load",this.clueImageLoaded),n.readAsDataURL(e)}if("propsIcon"==t.target.dataset.imgtype){this.createEventConfig.propsIconName=e.name;var o=new FileReader;o.addEventListener("load",this.propsIconLoaded),o.readAsDataURL(e)}if("propsImg"==t.target.dataset.imgtype){this.createEventConfig.propsImgName=e.name;var r=new FileReader;r.addEventListener("load",this.propsImgLoaded),r.readAsDataURL(e)}}},clueImageLoaded:function(t){this.createEventConfig.clueImg=t.target.result},propsIconLoaded:function(t){this.createEventConfig.propsIcon=t.target.result},propsImgLoaded:function(t){this.createEventConfig.propsImg=t.target.result},validateFileSize:function(t){var e=t.target.files.item(0).size/1024;e>50&&"clue"==t.target.dataset.imgtype&&(alert("上傳檔案大小不得超過 50 KB！"),this.createEventConfig.theClueFileIsTooBig=!0),e>10&&"propsIcon"==t.target.dataset.imgtype&&(alert("上傳檔案大小不得超過 10 KB！"),this.createEventConfig.thePropsIconFileIsTooBig=!0),e>50&&"propsImg"==t.target.dataset.imgtype&&(alert("上傳檔案大小不得超過 50 KB！"),this.createEventConfig.thePropsImgFileIsTooBig=!0);var n=t.target.files.item(0).type.split("/");"png"==n[1]||"pdf"==n[1]||"jpeg"==n[1]||"jpg"==n[1]||(alert("不支援的檔案格式！僅支援上傳 JPG, PNG, PDF 檔案。"),this.createEventConfig.theClueFileIsTooBig=!0)},selectPerUI:function(t){this.activePreview=t},getEventData:function(){var t=this;this.$axios.post("".concat("https://tmsys2020api.herokuapp.com","/event/getEventData"),{uid:sessionStorage.getItem("adminUid"),taskID:this.$route.params.id}).then((function(e){t.taskMissionIntroduction=e.data.missionIntroduction,t.tasksystemSetting=e.data.systemSetting}))},createTheEvent:function(){var t=this;if(this.disabledCreateBtn=!0,!this.checkInputVal())return alert("資料填寫不完整，請再次確認！"),void(this.disabledCreateBtn=!1);var e={eventContent:{name:this.eventContent.name,clueImg:this.createEventConfig.clueImg,propsIcon:this.createEventConfig.propsIcon,propsImg:this.createEventConfig.propsImg,answer:this.eventContent.answer,pass:!1,propsType:this.propsEffect,showGameImg:!1,showPropsImg:!1,score:this.eventContent.score},id:"".concat((new Date).getTime())},n=this.$route.params.id;this.$axios.post("".concat("https://tmsys2020api.herokuapp.com","/event/createEvent"),{clue:e,taskID:n,uid:sessionStorage.getItem("adminUid"),eventID:e.id}).then((function(e){"success"==e.data.message?(alert("事件已建立！"),t.$router.push({name:"admin-MgtEvent-MgtEvent",params:{MgtEvent:n}})):(alert("事件建立失敗！"),t.$router.push({name:"admin-MgtEvent-MgtEvent",params:{MgtEvent:n}}))})).catch((function(e){alert("事件建立失敗，請稍後嘗試！"),t.disabledCreateBtn=!1}))},checkInputVal:function(){return""==this.eventContent.name?this.remind.name="show":this.remind.name="close",""==this.eventContent.score?this.remind.score="show":this.remind.score="close",""==this.eventContent.answer?this.remind.answer="show":this.remind.answer="close",""==this.createEventConfig.clueImg?this.remind.clueImg="show":this.remind.clueImg="close","notHave"!==this.propsEffect&&(""==this.createEventConfig.propsImg?this.remind.propsImg="show":this.remind.propsImg="close",""==this.createEventConfig.propsIcon?this.remind.propsIcon="show":this.remind.propsIcon="close"),!(""==this.eventContent.name||""==this.eventContent.score||""==this.eventContent.answer||""==this.createEventConfig.clueImg||""==this.createEventConfig.propsImg&&"notHave"!==this.propsEffect||""==this.createEventConfig.propsIcon&&"notHave"!==this.propsEffect)}},mounted:function(){this.getEventData()}},r=(n(289),n(26)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrap"},[n("h3",[t._v("創建事件")]),t._v(" "),n("div",{staticClass:"form-group row pt-3"},[n("div",{staticClass:"col-8"},[n("div",{staticClass:"input-group mb-3",class:{remindBorder:"show"==t.remind.name}},[t._m(0),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.eventContent.name,expression:"eventContent.name"}],staticClass:"form-control",attrs:{type:"text",maxlength:"7",placeholder:"限7個字內"},domProps:{value:t.eventContent.name},on:{input:function(e){e.target.composing||t.$set(t.eventContent,"name",e.target.value)}}})]),t._v(" "),"show"==t.remind.name?n("div",{staticClass:"remindText"},[t._v("*事件名稱為必填欄位")]):t._e(),t._v(" "),n("div",{staticClass:"input-group mb-3",class:{remindBorder:"show"==t.remind.clueImg}},[t._m(1),t._v(" "),n("div",{staticClass:"custom-file"},[n("input",{staticClass:"custom-file-input",attrs:{type:"file",accept:"image/*","data-imgtype":"clue"},on:{change:t.fileSelectImg}}),t._v(" "),n("label",{staticClass:"custom-file-label"},[t._v(t._s(t.createEventConfig.clueImgName))])])]),t._v(" "),"show"==t.remind.clueImg?n("div",{staticClass:"remindText"},[t._v("*線索圖檔為必填欄位")]):t._e(),t._v(" "),n("div",{staticClass:"form-row mb-3"},[n("div",{staticClass:"col"},[n("div",{staticClass:"input-group",class:{remindBorder:"show"==t.remind.answer}},[t._m(2),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.eventContent.answer,expression:"eventContent.answer"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20"},domProps:{value:t.eventContent.answer},on:{input:function(e){e.target.composing||t.$set(t.eventContent,"answer",e.target.value)}}})]),t._v(" "),"show"==t.remind.answer?n("div",{staticClass:"remindText"},[t._v("*事件答案為必填欄位")]):t._e()]),t._v(" "),n("div",{staticClass:"col-4"},[n("div",{staticClass:"input-group",class:{remindBorder:"show"==t.remind.score}},[t._m(3),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.eventContent.score,expression:"eventContent.score"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.eventContent.score},on:{input:function(e){e.target.composing||t.$set(t.eventContent,"score",e.target.value)}}})]),t._v(" "),"show"==t.remind.score?n("div",{staticClass:"remindText"},[t._v("*事件分數為必填欄位")]):t._e()])]),t._v(" "),t._m(4),t._v(" "),t.tasksystemSetting.propsSys?n("div",{staticClass:"input-group mb-3"},[t._m(5),t._v(" "),n("div",{staticClass:"form-control"},[n("div",{staticClass:"form-check form-check-inline"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.propsEffect,expression:"propsEffect"}],staticClass:"form-check-input",attrs:{type:"radio",name:"propsEffect",id:"noUse",value:"notHave"},domProps:{checked:t._q(t.propsEffect,"notHave")},on:{change:function(e){t.propsEffect="notHave"}}}),t._v(" "),n("label",{staticClass:"form-check-label",attrs:{for:"noUse"}},[t._v("無")])]),t._v(" "),n("div",{staticClass:"form-check form-check-inline"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.propsEffect,expression:"propsEffect"}],staticClass:"form-check-input",attrs:{type:"radio",name:"propsEffect",id:"showPhoto",value:"propsImg"},domProps:{checked:t._q(t.propsEffect,"propsImg")},on:{change:function(e){t.propsEffect="propsImg"}}}),t._v(" "),n("label",{staticClass:"form-check-label",attrs:{for:"showPhoto"}},[t._v("圖片")])]),t._v(" "),t._m(6),t._v(" "),t._m(7)])]):t._e(),t._v(" "),"propsImg"==t.propsEffect?n("div",{staticClass:"input-group mb-3",class:{remindBorder:"show"==t.remind.propsIcon}},[t._m(8),t._v(" "),n("div",{staticClass:"custom-file"},[n("input",{staticClass:"custom-file-input",attrs:{type:"file",accept:"image/*","data-imgtype":"propsIcon"},on:{change:t.fileSelectImg}}),t._v(" "),n("label",{staticClass:"custom-file-label"},[t._v(t._s(t.createEventConfig.propsIconName))])])]):t._e(),t._v(" "),"show"==t.remind.propsIcon?n("div",{staticClass:"remindText"},[t._v("*道具圖示為必填欄位")]):t._e(),t._v(" "),"propsImg"==t.propsEffect?n("div",{staticClass:"input-group mb-3",class:{remindBorder:"show"==t.remind.propsImg}},[t._m(9),t._v(" "),n("div",{staticClass:"custom-file"},[n("input",{staticClass:"custom-file-input",attrs:{type:"file",accept:"image/*","data-imgtype":"propsImg"},on:{change:t.fileSelectImg}}),t._v(" "),n("label",{staticClass:"custom-file-label"},[t._v(t._s(t.createEventConfig.propsImgName))])])]):t._e(),t._v(" "),"show"==t.remind.propsImg?n("div",{staticClass:"remindText"},[t._v("*道具圖檔為必填欄位")]):t._e()]),t._v(" "),n("div",{staticClass:"col-4"},[n("div",{staticClass:"d-flex mb-3"},[n("div",{staticClass:"previewUI"},[n("ul",{staticClass:"list-group list-group-flush"},[n("li",{staticClass:"list-group-item uiStyle",class:{"ui-active":"clue"==t.activePreview},attrs:{title:"線索圖檔"},on:{click:function(e){return t.selectPerUI("clue")}}},[n("fa",{attrs:{icon:["fas","search"]}})],1),t._v(" "),"notHave"!==t.propsEffect?n("li",{staticClass:"list-group-item uiStyle",class:{"ui-active":"propsIcon"==t.activePreview},attrs:{title:"道具圖示"},on:{click:function(e){return t.selectPerUI("propsIcon")}}},[n("fa",{attrs:{icon:["fas","paw"]}})],1):t._e(),t._v(" "),"propsImg"==t.propsEffect?n("li",{staticClass:"list-group-item uiStyle",class:{"ui-active":"propsImg"==t.activePreview},attrs:{title:"道具圖檔"},on:{click:function(e){return t.selectPerUI("propsImg")}}},[n("fa",{attrs:{icon:["fas","box"]}})],1):t._e()])]),t._v(" "),n("ul",{staticClass:"list-group",staticStyle:{width:"100%"}},["clue"==t.activePreview?n("li",{staticClass:"list-group-item"},[t.createEventConfig.clueImg?n("div",{staticClass:"preImgView",style:"background-image: url("+t.createEventConfig.clueImg+");"}):n("div",{staticClass:"preEmptyView"},[n("span",[t._v("線索圖")]),t._v(" "),n("span",[t._v("建議大小")]),t._v(" "),n("span",[t._v("320 x 600")])])]):t._e(),t._v(" "),"propsIcon"==t.activePreview?n("li",{staticClass:"list-group-item"},[t.createEventConfig.propsIcon?n("div",{staticClass:"preImgView",style:"background-image: url("+t.createEventConfig.propsIcon+");"}):n("div",{staticClass:"propsEmptyView"},[n("span",[t._v("道具圖示")]),t._v(" "),n("span",[t._v("建議大小")]),t._v(" "),n("span",[t._v("120 x 120")])])]):t._e(),t._v(" "),"propsImg"==t.activePreview?n("li",{staticClass:"list-group-item"},[t.createEventConfig.propsImg?n("div",{staticClass:"preImgView",style:"background-image: url("+t.createEventConfig.propsImg+");"}):n("div",{staticClass:"preEmptyView"},[n("span",[t._v("道具圖")]),t._v(" "),n("span",[t._v("建議大小")]),t._v(" "),n("span",[t._v("320 x 600")])])]):t._e()])]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-block mt-2",attrs:{type:"submit",disabled:t.disabledCreateBtn},on:{click:t.createTheEvent}},[t.disabledCreateBtn?n("div",{staticClass:"spinner-border spinner-border-sm text-light",attrs:{role:"status"}},[n("span",{staticClass:"sr-only"},[t._v("Loading...")])]):n("span",[t._v("建立任務")])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[this._v("事件名稱")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[this._v("線索圖檔")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[this._v("事件答案")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[this._v("事件分數")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group mb-3"},[e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[e("input",{attrs:{type:"checkbox",disabled:""}})]),this._v(" "),e("span",{staticClass:"input-group-text gpsCheckbox"},[this._v("啟用 GPS 座標定位")])]),this._v(" "),e("input",{staticClass:"form-control",attrs:{type:"text",placeholder:"輸入座標",disabled:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[this._v("道具效果")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-check form-check-inline"},[e("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"propsEffect",id:"interModal",disabled:""}}),this._v(" "),e("label",{staticClass:"form-check-label",attrs:{for:"interModal"}},[this._v("互動")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-check form-check-inline"},[e("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"propsEffect",id:"gamsTask",disabled:""}}),this._v(" "),e("label",{staticClass:"form-check-label",attrs:{for:"gamsTask"}},[this._v("遊戲")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[this._v("道具圖示")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[this._v("道具圖檔")])])}],!1,null,"58d785ec",null);e.default=component.exports}}]);